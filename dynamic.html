<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="stylesheet" type="text/css" href="src/css/component.css" />
		<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
	</head>

	<body>
		<div id="app">
			<ul class="reset-ul row t-c">
				<li class="col-xs-4">
					<a href="javascript:;" class="g-bg-primary reset-a on-get-tmpl block pd-10" data-add="tm1" data-wrap="tm-1">tm1</a>
				</li>
				<li class="col-xs-4">
					<a href="javascript:;" class="reset-a on-get-tmpl block pd-10" data-add="tm2" data-wrap="tm-2">tm2</a>
				</li>
				<li class="col-xs-4">
					<a href="javascript:;" class="reset-a on-get-tmpl block pd-10" data-add="tm3" data-wrap="tm-3">tm3</a>
				</li>
			</ul>
		</div>

		<div class="row" id="content">
			<div class="row" id="tm-1">
				<h3>tm1</h3>
				<div class="content">
					
				</div>
				<div class="row pd-10 t-c">
					<button class="g-btn g-btn-primary g-btn-radius on-add-tm1">add</button>
				</div>
			</div>

			<div class="row" id="tm-2" style="display: none;">
				<h3>tm2</h3>
				<div class="content">
					
				</div>
				<div class="row pd-10 t-c">
					<button class="g-btn g-btn-danger g-btn-radius  on-add-tm2">add</button>
				</div>
			</div>

			<div class="row" id="tm-3" style="display: none;">
				<h3>tm3</h3>
				<div class="content">
					
				</div>
				<div class="row pd-10 t-c">
					<button class="g-btn g-btn-success g-btn-radius  on-add-tm3">add</button>
				</div>
			</div>
		</div>

		<script type="text/template" id="tm">
			<tmpl name="tm1"></tmpl>
		</script>

		<script src="src/js/tmlp.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			var app = new Tmpl({
				el: "tm",
				methods: {
					getTmpl: function(tm) {
						var _this = this;
						if(this.hasId(tm)) return this;
						$.ajax({
							url: './php/get_tmpl.php?tmpl=' + tm,
							success: function(data) {
								_this.append(document.body, _this.create(data.tmpl))
									.cb(function() {
										_this.update();
									});
							}
						});
					},
					add: function(event, el) {
						
						if(el.isCheck == true) return;						
						var _this = this;
						var parent = this.parent(el);
						
						this.fn.each(this.siblings(parent), function(e, index) {
							var a = e.children[0];
							_this.removeClass(a, 'g-bg-primary');
							a.isCheck = false;
						});

						this.addClass(el, 'g-bg-primary');

						var tmplName = this.attr(el, 'data-add');

						var content = this.attr(el, 'data-wrap');

						var siblings = this.siblings(this.fn.getEl(content));

						this.fn.each(siblings, function(e, index) {
							_this.hide(e);
						});
						
						el.isCheck = true; 

						_this.show(this.fn.getEl(content),2000);

						this.getTmpl(tmplName);
					}
				},
				events: function() {
					this.on('on-get-tmpl', 'click', this.add);
				},
				mounted: function() {
					this.getTmpl('tm1');
				}
			})
		</script>
	</body>

</html>