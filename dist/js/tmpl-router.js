/**
*
*
* tmpl-router.js v1.0.1
* (c) 2016-2017 Blue
* https://github.com/azhanging/tmpl
* Released under the MIT License.
*
*
**/
!function(t,e){"function"==typeof _require?_require.defineId("tmpl-router",e):"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("tmpl-router",[],e):t?t.TmplRouter=e():{}}("undefined"!=typeof window?window:this,function(){function t(t){return window.hasTmplRouter?{}:void this.init(t)}function e(){var t=this;this.changeRoutereStatus(!0);var e=y.getEls(this.config.routerLink);y.each(e,function(e,r){y.on(e,"click",function(e){t.routerStatus||e.preventDefault()})})}function r(t){g.on(document,this.config.routerAnchor,"click",function(e,r){var o=g.attr(r,"tmpl-anchor"),i=g.attr(r,"tmpl-anchor-top");i=y.isNum(i)?Number(i):0;var n=y.getEl(o);y.isEl(n)&&g.animate(document,{scrollTop:g.offset(n).top+i},t)})}function o(t,e){var r=this,i=e?e:"";y.each(t,function(t,e){y.isObj(t.modules)&&o.apply(r,[t.modules,i+e]),r.router[i+e]=t,delete t.modules})}function i(t,e,r){var o=this,i=null,u=this.getHash(e);o.getTmpl(u),w&&s.call(o,w),w=u,a.apply(o,[u,r]),n.call(this,u),y.each(t,function(t,e){var r=g.attr(t,"href"),n=o.getHash(r);n===u?(o.currentRouter=n,i=t,g.addClass(t,o.config.routerLinkActive),o.config.keepLive&&o.router[n].keepLive?c.call(this,o.router[n].scrollTop):c.call(this,0)):(o.router[n]&&s.call(o,n),g.removeClass(t,o.config.routerLinkActive)),i||(o.currentRouter=u)}),y.run(this.config.routerEntered,this,[e,r,i])}function n(t){void 0!==this.router[t].routerStatus&&this.changeRoutereStatus(!0)}function u(){var t=this;this.config.keepLive&&y.on(window,"scroll",function(e){t.router[t.currentRouter]&&t.router[t.currentRouter].keepLive&&(t.router[t.currentRouter].scrollTop=document.body.scrollTop||document.documentElement.scrollTop)})}function c(t){if(!y.isNum(t))return 0;try{document.body.scrollTop=parseFloat(t)}catch(e){document.documentElement.scrollTop=parseFloat(t)}}function s(t){var e=this;y.each(e.router[t].view,function(r,o){e.router[t].temp.appendChild(r)}),this.router[t].view=[]}function a(t,e){var r=this;e.appendChild(this.router[t].temp),y.each(g.children(e),function(e,o){r.router[t].view.push(e)})}function h(t,e,r){var o=this.getHash(t),i=this.alias[o];return this.router[o]&&(y.run(this.config.routerEnter,this,[t,e,r]),y.run(this.config.routerEntered,this,[t,e,r])),this.alias[i]?h.apply(this,[i,e,r]):i}function l(t){y.each(t.childNodes,function(t,e){t&&3===t.nodeType&&""===t.textContent.trim()&&g.remove(t)})}function p(t){var e=this;this.alias={},y.each(t,function(t,r){var o=t.alias;e.router[r].view=[],e.config.keepLive&&void 0===e.router[r].keepLive&&(e.router[r].keepLive=!0),e.router[r].temp=document.createDocumentFragment(),o&&(e.alias[o]=r)})}function f(){var t=this;window.hasTmplRouter||(window.onhashchange=function(e){window.location.hash;t.hashChange(),g.preventDefault(e)},window.hasTmplRouter=!0)}function d(t){var e=this,r=this.config[t];y.isObj(r)&&y.each(r,function(t,r){e[r]=t})}var m={routerLink:"tmpl-router",routerLinkActive:"tmpl-router-active",routerView:"tmpl-router-view",routerAnchor:"tmpl-router-anchor",anchorTime:1e3,data:{},methods:{}},v=null,g=null,y=null,w=null;return t.install=function(e){return this.installed?t:(this.installed=!0,v=e,g=new v({}),void(y=g.fn))},window.Tmpl&&t.install(Tmpl),t.prototype.init=function(t){this.router={},this.config=y.extend(y.copy(m),t),o.call(this,this.config.router?this.config.router:{}),this.tmpl=g,d.call(this,"methods"),d.call(this,"data"),e.call(this),r.call(this,this.config.anchorTime),u.call(this),p.call(this,this.router),f.call(this),y.run(this.config.created,this),this.hashChange(),y.run(this.config.mounted,this)},t.prototype.set=function(t){var e=this;return y.isObj(t)&&y.each(t,function(t,r){e.router[r]=t}),p.call(this,t),this},t.prototype.hashChange=function(){var t=window.location.hash.replace("#",""),e=this.getHash(t),r=y.getEls(this.config.routerLink),o=y.getEl(this.config.routerView),n=!1;return""===e&&(e="/"),this.alias[e]&&(n=!0,e=h.apply(this,["/"===e?e:t,o,null])),0===r.length?this:this.alias[e]||this.router[e]?(y.run(this.config.routerEnter,this,[t,o]),void 0!==this.router[e].routerStatus&&this.changeRoutereStatus(!0),void i.apply(this,[r,n?e:t,o])):void y.run(this.config.error,this)},t.prototype.go=function(t){y.isNum(t)&&history.go(t)},t.prototype.redirect=function(t){t=t.replace("#","");var e=location.href.split("#");"/"===t?location.href=e[0]:(e[1]=t,location.href=e.join("#"))},t.prototype.getTmpl=function(t){var e=this;if(!(!this.router[t]||this.router[t].view.length>0||this.router[t].temp.childNodes.length>0)){var r=this.router[t].tmplUrl,o=this.router[t].tmplId;if(r)try{g.fn.ajax({async:!1,url:r,success:function(r){e.router[t].temp.appendChild(g.create(r.tmpl)),l.call(this,e.router[t].temp),e.changeRoutereStatus(!1)},error:function(t){e.changeRoutereStatus(!0)}})}catch(i){$.ajax({async:!1,url:r,success:function(r){e.router[t].temp.appendChild(g.create(r.tmpl)),l.call(this,e.router[t].temp),e.changeRoutereStatus(!1)},error:function(t){e.changeRoutereStatus(!0)}})}else if(o){try{e.router[t].temp.appendChild(g.create(g.html(y.getEl(o))))}catch(i){e.router[t].temp.appendChild(g.create(""))}e.changeRoutereStatus(!0)}}},t.prototype.query=function(t){if(!y.isStr(t))return{};var e={},r=t.split("&");return y.each(r,function(t,r){var o=t.split("=");if(1!==o.length){var i=o[0],n=o[1];e[i]=n}}),e},t.prototype.search=function(t,e){try{var r=g.attr(t,"href").split("?")}catch(o){var r=t.split("?")}return e?(y.isObj(e)&&(e=y.serialize(e)),r[1]=e,g.attr(t,{href:r.join("?")}),void 0):r[1]},t.prototype.getHash=function(t){void 0===t&&(t=window.location.hash.replace("#",""));var e="";return e=t.replace("#","").split("?"),e[0]},t.prototype.changeRoutereStatus=function(t){this.routerStatus=t},t.version="v1.0.1",t});