/**
*
*
* tmpl-router.js v1.0.0
* (c) 2016-2017 Blue
* https://github.com/azhanging/tmpl
* Released under the MIT License.
*
*
**/
!function(t,e){"function"==typeof _require?_require.defineId("tmpl-router",e):t?t.TmplRouter=e():{}}("undefined"!=typeof window?window:this,function(){function t(t){this.init(t)}function e(t,i){var r=this,n=i?i:"";v.each(t,function(t,i){r.router[n+i]=t,v.isObj(t.modules)&&e.apply(r,[t.modules,n+i])})}function i(t,e,i){var r=this,a=null,u=e,l="";v.each(t,function(t,h){var c=d.attr(t,"href").replace("#","").split("?"),p=c[0],f=c[1]?c[1]:"";p===e?(r.currentRouter=p,u=c.join("?"),l=f,a=t,r.getTmpl(t,e),m&&o.call(r,m),s.apply(r,[p,i]),d.addClass(t,r.config.activeClassName),m=e,r.config.keepLive&&r.router[p].keepLive?n.call(this,r.router[p].scrollTop):n.call(this,0)):(r.router[p]&&o.call(r,p),d.removeClass(t,r.config.activeClassName)),a||(r.currentRouter=e),r.router[p]&&(r.router[p].path={path:c.join(""),hash:p,search:f})}),v.run(this.config.routerEntered,this,[{path:u,hash:e,search:l},i,a])}function r(){var t=this;this.config.keepLive&&v.on(window,"scroll",function(e){t.router[t.currentRouter]&&t.router[t.currentRouter].keepLive&&(t.router[t.currentRouter].scrollTop=document.body.scrollTop||document.documentElement.scrollTop)})}function n(t){if(!v.isNum(t))return 0;try{document.body.scrollTop=parseFloat(t)}catch(e){document.documentElement.scrollTop=parseFloat(t)}}function o(t){var e=this;v.each(e.router[t].view,function(i,r){e.router[t].temp.appendChild(i)}),this.router[t].view=[]}function s(t,e){var i=this;e.appendChild(this.router[t].temp),v.each(d.children(e),function(e,r){i.router[t].view.push(e)})}function a(t,e,i){var r=this.alias[t.hash];return this.router[t.hash]&&v.run(this.config.routerEntered,this,[t,e,i]),this.alias[r]?a.apply(this,[t,e,i]):r}function u(t){v.each(t.childNodes,function(t,e){3===t.nodeType&&""===t.textContent.trim()&&d.remove(t)})}function l(t){var e=this;this.alias={},v.each(t,function(t,i){var r=t.alias;e.router[i].view=[],void 0===e.router[i].keepLive&&(e.router[i].keepLive=!0),e.router[i].temp=document.createDocumentFragment(),r&&(e.alias[r]=i)})}function h(){var t=this;window.hasTmplRouter||v.on(window,"hashchange",function(e){window.location.hash;t.hashChange(),d.preventDefault(e)})}function c(t){var e=this,i=this.config[t];v.isObj(i)&&v.each(i,function(t,i){e[i]=t})}var p={created:function(){},routerLink:"tmpl-router",activeClassName:"tmpl-router-active",routerView:"tmpl-router-view",data:{},methods:{},error:function(){}},f=null,d=null,v=null,m=null;return t.install=function(e){return this.installed?t:(this.installed=!0,f=e,d=new f({}),void(v=d.fn))},window.Tmpl&&t.install(Tmpl),t.prototype={constructor:t,init:function(t){this.config=v.extend(v.copy(p),t),this.router={},e.call(this,this.config.router?this.config.router:{}),this.tmpl=d,c.call(this,"methods"),c.call(this,"data"),r.call(this),l.call(this,this.router),h.call(this),this.hashChange(),v.run(this.config.mounted,this)},set:function(t){var e=this;return v.isObj(t)&&v.each(t,function(t,i){e.router[i]=t}),l.call(this,t),this},hashChange:function(){var t=window.location.hash.replace("#","").split("?"),e=t[0],r=t[1],n=v.getEls(this.config.routerLink),o=v.getEl(this.config.routerView);return""===e&&(e="/"),this.alias[e]&&(e=a.apply(this,[{path:t.join(""),hash:e,search:r},o,null])),0===n.length?this:this.alias[e]||this.router[e]?void i.apply(this,[n,e,o]):void this.config.error.call(this)},go:function(t){v.isNum(t)&&history.go(t)},redirect:function(t){t=t.replace("#","");var e=location.href.split("#");"/"===t?location.href=e[0]:(e[1]=t,location.href=e.join("#"))},getTmpl:function(t,e){var i=this;if(!(!this.router[e]||this.router[e].temp.childNodes.length>0||this.router[e].view.length>0)){var r=this.router[e].tmplUrl,n=this.router[e].tmplId;r?d.fn.ajax({async:!1,url:r,success:function(t){i.router[e].temp.appendChild(d.create(t.tmpl)),u.call(this,i.router[e].temp)}}):n&&i.router[e].temp.appendChild(d.create(d.html(v.getEl(n))))}},query:function(t){if(!v.isStr(i))return{};var e={},i=t.split("&");return v.each(i,function(t,i){var r=t.split("=");if(1!==r.length){var n=r[0],o=r[1];e[n]=o}}),e},search:function(t,e){var i=d.attr(t,"href").split("?");return e?(v.isObj(e)&&(e=v.serialize(e)),i[1]=e,d.attr(t,{href:i.join("?")}),void 0):i[1]},getHash:function(t){var e="";return e=t.indexOf("#")===-1?t.split("?"):t.replace("#","").split("?"),e[0]}},t.version="v1.0.0",t});